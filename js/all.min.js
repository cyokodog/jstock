var app=angular.module("app",["ui.router"]);app.constant("CONFIG",{API_ENDPOINT:"http://jquerydb.aws.af.cm/jstock/webapi/"}),app.factory("fetchCategoryService",["$http","$q","CONFIG",function(t,e,r){return{exec:function(a){var c=e.defer();return t.jsonp(r.API_ENDPOINT,{params:angular.extend({callback:"JSON_CALLBACK",contentsType:"category"},a)}).success(function(t){c.resolve(t)}),c.promise}}}]),app.factory("fetchArticleService",["$http","$q","CONFIG",function(t,e,r){return{exec:function(a){["page","page_no","category_id","single_id"].forEach(function(t){a[t]=a[t]||"*"});var c=e.defer();return t.jsonp(r.API_ENDPOINT,{params:angular.extend({callback:"JSON_CALLBACK",contentsType:"article"},a)}).success(function(t){c.resolve(t)}),c.promise}}}]),app.config(["$stateProvider","$urlRouterProvider","$locationProvider",function(t,e,r){e.otherwise("/"),t.state("home",{url:"/",views:{viewArticle:{template:'<list-page ctrl="ctrl" data="ctrl.data" state="ctrl.state"/>',controllerAs:"ctrl",controller:"mainController"}}}).state("category",{url:"/{pageId:library|jser}/category/{categoryId:.+}",views:{viewArticle:{template:'<list-page ctrl="ctrl" data="ctrl.data" state="ctrl.state"/>',controllerAs:"ctrl",controller:"mainController"}}}).state("page",{url:"/{pageId:library|jser}",views:{viewArticle:{template:'<list-page ctrl="ctrl" data="ctrl.data" state="ctrl.state"/>',controllerAs:"ctrl",controller:"mainController"}}}).state("article",{url:"/{pageId:library|jser}/{articleId:.+}",views:{viewArticle:{template:'<article-page ctrl="ctrl" data="ctrl.data" state="ctrl.state"/>',controllerAs:"ctrl",controller:"mainController"}}})}]),app.controller("mainController",["$stateParams","fetchArticleService",function(t,e){var r=this;r.state=t;var a=function(a){e.exec({page:t.pageId||"home",page_no:a,category_id:t.categoryId||"*",single_id:t.articleId||"*"}).then(function(e){r.data=e,"jser"==t.pageId&&(r.data.plugins_qty>0?r.data.jserCategory="1"==r.data.jp_flg?{type:"japanese-creator",name:"Japanese Creator"}:{type:"creator",name:"Creator"}:"1"==r.data.jp_flg&&(r.data.jserCategory={type:"japanese-reviewer",name:"Japanese Reviewer"})),r.data.info=e.article_list_info[0],r.data.isNextPage=r.data.info.next_page_no>a,r.data.isPrevPage=a>1})},c=1;a(c),r.nextPage=function(){c++,a(c),document.body.scrollTop=0},r.prevPage=function(){c--,a(c),document.body.scrollTop=0},document.body.scrollTop=0}]),app.directive("listPage",function(){return{scope:{c:"=ctrl",d:"=data",s:"=state"},restrict:"E",templateUrl:"directive/list_page.html"}}),app.directive("articlePage",function(){return{scope:{c:"=ctrl",d:"=data",s:"=state"},restrict:"E",templateUrl:"directive/article_page.html"}}),app.directive("libraryCard",function(){return{scope:{c:"=ctrl",d:"=data",s:"=state"},restrict:"E",templateUrl:"directive/library_card.html"}}),app.directive("jserCard",function(){return{scope:{c:"=ctrl",d:"=data",s:"=state"},restrict:"E",templateUrl:"directive/jser_card.html"}}),app.directive("libraryArticle",function(){return{scope:{c:"=ctrl",d:"=data",s:"=state"},restrict:"E",templateUrl:"directive/library_article.html"}}),app.directive("jserArticle",function(){return{scope:{c:"=ctrl",d:"=data",s:"=state"},restrict:"E",templateUrl:"directive/jser_article.html"}}),app.directive("categoryList",function(){return{scope:{},require:"categoryList",restrict:"E",templateUrl:"directive/category_list.html",link:function(t,e,r,a){a.init()},controllerAs:"ctrl",controller:["$scope","fetchCategoryService",function(t,e){var r=this;r.data={},r.init=function(){e.exec().then(function(t){r.data.category=t})}}]}});